---
title: MCMC
author: ZERO
date: '2018-08-13'
slug: mcmc
categories:
  - Math
tags:
  - probability
thumbnailImagePosition: left
thumbnailImage: https://i.loli.net/2018/08/13/5b70bd4dc9763.jpg
metaAlignment: center
coverMeta: out
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,#show code and output
	message = FALSE,
	warning = FALSE,
	engine.path="/Users/zero/anaconda3/bin/python"
)
```

> “MCMC 就是一种通过在<strong style="color: darkred;">概率空间</strong> 中<strong style="color: darkred;">随机采样</strong> 来近似<strong style="color: darkred;">感兴趣参数的后验分布</strong> 的方法”

## Concept
<strong style="color: darkred;">感兴趣的参数</strong> 只是用来抽象我们感兴趣的现象的一些数字。通常我们会使用统计的方法来估计这些参数。例如，如果我们想了解成年人的身高，那么我们需要的参数可能就是以英寸为单位的平均身高。

<strong style="color: darkred;">分布</strong> 就是参数的各个可能值和我们能观察到每个参数的可能性的数学表示。分布描述了我们对参数的确信度。因此，上面的钟形曲线可以表明我们非常确定参数的值接近于零，同时我们认为真实值高于或低于该值的可能性是相等的。

在得到任何数据之前，通过以往的知识，对参数确信度的描述分布被称为<strong style="color: darkred;">先验分布</strong> 。

<strong style="color: darkred;">从总体出发估计样本（观察数据）通过概率（probability）体现，从样本出发估计总体通过统计推论（infer）解释</strong> 。一般样本有具体的数值，而总体通过参数表示。

<strong style="color: darkred;">似然分布</strong> 以参数值范围的形式总结了数据可以告诉我们什么，而参数范围值中的每个参数解释了我们正在观察的数据的可能性，属于从总体（参数值范围中的每个参数）出发估计现有样本的可能性。估计最大似然分布的参数值就是回答了这个问题：什么样的参数值能使分布最有可能观察到我们观察得到的数据？在没有先验信息的情况下，我们可能会就此打住，无法进行下去了。

<strong style="color: darkred;">贝叶斯分析</strong> 的关键是将先验信息和似然分布结合起来去确定后验分布（可以把它看作一种先验和可能性分布的平均值）。这告诉我们，在有先验数据的情况下，哪些参数值能够最大化观察到我们指定数据的可能性，缩小了似然分布的参数值范围

先验分布较短且较为分散，所以它代表了一组关于平均人体身高真实值 “不太确定” 的概率。 同时，可能性分布在相对较窄的范围内就可以总结数据，因此它代表了对真实参数值 “更确定” 的概率。当先验和可能性结合在一起时，数据（可能性分布表示）弱化了个体在巨人中长大的可能性，纠正了先验分布。 尽管那个人仍然认为人的平均身高比数据告诉他的稍高一些，但是他最相信的还是数据。

## MCMC
回到最初的问题：<strong style="color: darkred;">我们试图估计我们感兴趣参数的后验分布，即人均身高μ</strong> ：

我们知道后验分布在先验分布和似然分布范围内，但是，我们很难直接计算它，MCMC 方法考虑选择一个随机参数值。然后模拟会继续生成随机值（这是蒙特卡罗的一部分），但要根据一些规则来确定什么是一个好的参数值。这个诀窍就是，对于一对参数值，基于先验信息，通过计算每个值在解释数据时的可能性有多大，来计算哪个参数值更好。如果随机生成的参数值比最后一个参数值更好，则以一定的概率值将其添加到参数值链中（这是马尔科夫链部分）

<strong style="color: darkred;">对于单个参数</strong> ，MCMC 方法是沿 x 轴开始随机采样：由于<strong style="color: darkred;">随机样本受到固定概率</strong> 的影响，经过一段时间之后，它们往往会在我们感兴趣参数概率最高的区域<strong style="color: darkred;">收敛</strong> ，在数据收敛之后，<strong style="color: darkred;">MCMC 抽样产生一组来自后验分布的样本点</strong> 。 在这些点周围绘制直方图，并计算任何您喜欢的统计数据。

根据 MCMC 模拟生成的样本集计算出的任何统计量就是我们对该真实后验分布统计量的最佳预测。

MCMC 方法也可以用来估计多个参数的后验分布（比如说人的身高和体重）。

对于 n 个参数，存在 n 维空间中的高概率区域，这些区域中的某些参数值组可以更好地解释观察到的数据。 因此，我认为 MCMC 是一种在概率空间内进行随机采样来接近后验分布的方法
